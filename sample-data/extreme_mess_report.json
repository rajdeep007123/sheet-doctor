{
  "contract": {
    "name": "csv_doctor.report",
    "version": "1.0.0"
  },
  "schema_version": "1.0.0",
  "tool_version": "0.5.0-dev",
  "file_overview": {
    "file": "extreme_mess.csv",
    "rows": 51,
    "parsed_rows": 46,
    "malformed_rows": 8,
    "dropped_rows": 5,
    "columns": 8,
    "format": "csv",
    "encoding": "WINDOWS-1250",
    "scanned_at": "2026-03-01T11:47:39"
  },
  "health_score": {
    "score": 32,
    "label": "Poor â€” major surgery required",
    "deductions": {
      "encoding": 10,
      "structural": 30,
      "date_chaos": 5,
      "missing_data": 3,
      "duplicates": 10,
      "data_quality": 10
    },
    "metrics": {
      "overall_null_percentage": 11.14,
      "encoding_issue_count": 2,
      "structural_issue_count": 3,
      "date_columns_affected": 1,
      "semantic_issue_types": 5
    }
  },
  "raw_health_score": {
    "score": 32,
    "label": "Poor â€” major surgery required",
    "deductions": {
      "encoding": 10,
      "structural": 30,
      "date_chaos": 5,
      "missing_data": 3,
      "duplicates": 10,
      "data_quality": 10
    },
    "metrics": {
      "overall_null_percentage": 11.14,
      "encoding_issue_count": 2,
      "structural_issue_count": 3,
      "date_columns_affected": 1,
      "semantic_issue_types": 5
    }
  },
  "recoverability_score": {
    "score": 71,
    "label": "Good â€” a few issues to address",
    "metrics": {
      "clean_rows": 42,
      "quarantine_rows": 5,
      "needs_review_rows": 11,
      "modified_rows": 40,
      "salvage_ratio": 0.8936
    }
  },
  "post_heal_score": {
    "score": 79,
    "label": "Good â€” a few issues to address",
    "deductions": {
      "encoding": 0,
      "structural": 0,
      "date_chaos": 5,
      "missing_data": 1,
      "duplicates": 5,
      "data_quality": 10
    },
    "metrics": {
      "overall_null_percentage": 2.98,
      "encoding_issue_count": 0,
      "structural_issue_count": 0,
      "date_columns_affected": 1,
      "semantic_issue_types": 5
    }
  },
  "issues": {
    "critical": [
      {
        "id": "structural_misaligned_rows",
        "severity": "critical",
        "plain_english": "Some rows have too many or too few columns, which will break imports and shift values into the wrong fields.",
        "columns": [
          "row structure"
        ],
        "rows_affected": 8,
        "auto_fixable": true,
        "details": {
          "rows": [
            {
              "row": 10,
              "count": 9
            },
            {
              "row": 12,
              "count": 9
            },
            {
              "row": 22,
              "count": 9
            },
            {
              "row": 45,
              "count": 9
            },
            {
              "row": 48,
              "count": 9
            },
            {
              "row": 50,
              "count": 6
            },
            {
              "row": 51,
              "count": 5
            },
            {
              "row": 52,
              "count": 4
            }
          ]
        }
      },
      {
        "id": "structural_repeated_header_rows",
        "severity": "critical",
        "plain_english": "The header row appears again inside the data, which will be treated as a broken data row during import.",
        "columns": [
          "row structure"
        ],
        "rows_affected": 1,
        "auto_fixable": true,
        "details": {
          "rows": [
            17
          ]
        }
      }
    ],
    "warning": [
      {
        "id": "encoding_non_utf8",
        "severity": "warning",
        "plain_english": "The file uses WINDOWS-1250 instead of UTF-8, so some systems may misread special characters.",
        "columns": [
          "file-wide"
        ],
        "rows_affected": 51,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "semantic_inconsistent_capitalisation",
        "severity": "warning",
        "plain_english": "The Employee Name column uses inconsistent capitalisation, which can split what should be one category into several versions.",
        "columns": [
          "Employee Name"
        ],
        "rows_affected": 49,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "date_mixed_formats",
        "severity": "warning",
        "plain_english": "The Date column mixes multiple date formats, so the same date may be interpreted differently by different tools.",
        "columns": [
          "Date"
        ],
        "rows_affected": 47,
        "auto_fixable": true,
        "details": {
          "formats_found": [
            "DD/MM/YYYY or MM/DD/YYYY",
            "Month D, YYYY",
            "YYYY-MM-DD",
            "DD-MM-YY or MM-DD-YY"
          ]
        }
      },
      {
        "id": "semantic_inconsistent_capitalisation",
        "severity": "warning",
        "plain_english": "The Department column uses inconsistent capitalisation, which can split what should be one category into several versions.",
        "columns": [
          "Department"
        ],
        "rows_affected": 47,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "semantic_near_duplicates",
        "severity": "warning",
        "plain_english": "The Department column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.",
        "columns": [
          "Department"
        ],
        "rows_affected": 47,
        "auto_fixable": false,
        "details": {}
      },
      {
        "id": "semantic_inconsistent_capitalisation",
        "severity": "warning",
        "plain_english": "The Currency column uses inconsistent capitalisation, which can split what should be one category into several versions.",
        "columns": [
          "Currency"
        ],
        "rows_affected": 46,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "semantic_near_duplicates",
        "severity": "warning",
        "plain_english": "The Currency column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.",
        "columns": [
          "Currency"
        ],
        "rows_affected": 46,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "semantic_near_duplicates",
        "severity": "warning",
        "plain_english": "The Amount column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.",
        "columns": [
          "Amount"
        ],
        "rows_affected": 45,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "semantic_outliers",
        "severity": "warning",
        "plain_english": "The Amount column contains outlier values that look unusually large or small compared with the rest of the file.",
        "columns": [
          "Amount"
        ],
        "rows_affected": 45,
        "auto_fixable": false,
        "details": {}
      },
      {
        "id": "semantic_inconsistent_capitalisation",
        "severity": "warning",
        "plain_english": "The Status column uses inconsistent capitalisation, which can split what should be one category into several versions.",
        "columns": [
          "Status"
        ],
        "rows_affected": 44,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "semantic_near_duplicates",
        "severity": "warning",
        "plain_english": "The Status column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.",
        "columns": [
          "Status"
        ],
        "rows_affected": 44,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "encoding_suspicious_chars",
        "severity": "warning",
        "plain_english": "Some characters look corrupted, which may change names, notes, or other text values.",
        "columns": [
          "file-wide"
        ],
        "rows_affected": 3,
        "auto_fixable": true,
        "details": {}
      },
      {
        "id": "structural_empty_rows",
        "severity": "warning",
        "plain_english": "Completely blank rows are mixed into the file and can interfere with import counts and analysis.",
        "columns": [
          "row structure"
        ],
        "rows_affected": 2,
        "auto_fixable": true,
        "details": {
          "rows": [
            7,
            14
          ]
        }
      }
    ],
    "info": [
      {
        "id": "semantic_pii",
        "severity": "info",
        "plain_english": "The Employee Name column appears to contain personally identifiable information that may need extra care before sharing.",
        "columns": [
          "Employee Name"
        ],
        "rows_affected": 49,
        "auto_fixable": false,
        "details": {}
      }
    ]
  },
  "column_breakdown": [
    {
      "column": "Employee Name",
      "detected_type": "name",
      "null_percentage": 4.35,
      "top_issues": [
        "Inconsistent capitalisation",
        "Possible PII detected (emails/phones/names)"
      ]
    },
    {
      "column": "Department",
      "detected_type": "categorical",
      "null_percentage": 8.7,
      "top_issues": [
        "Inconsistent capitalisation",
        "Possible duplicates with slight differences"
      ]
    },
    {
      "column": "Date",
      "detected_type": "date",
      "null_percentage": 8.7,
      "top_issues": [
        "Mixed date formats detected",
        "Inconsistent capitalisation"
      ]
    },
    {
      "column": "Amount",
      "detected_type": "currency/amount",
      "null_percentage": 13.04,
      "top_issues": [
        "Possible duplicates with slight differences",
        "Outliers detected (values outside 3 standard deviations)"
      ]
    },
    {
      "column": "Currency",
      "detected_type": "currency code",
      "null_percentage": 10.87,
      "top_issues": [
        "Inconsistent capitalisation",
        "Possible duplicates with slight differences"
      ]
    },
    {
      "column": "Category",
      "detected_type": "categorical",
      "null_percentage": 13.04,
      "top_issues": [
        "No major issues detected"
      ]
    },
    {
      "column": "Status",
      "detected_type": "categorical",
      "null_percentage": 15.22,
      "top_issues": [
        "Inconsistent capitalisation",
        "Possible duplicates with slight differences"
      ]
    },
    {
      "column": "Notes",
      "detected_type": "free text",
      "null_percentage": 15.22,
      "top_issues": [
        "No major issues detected"
      ]
    }
  ],
  "recommended_actions": [
    "Run sheet-doctor healing now: it can automatically address 8 issue type(s) across 13 flagged issue instance(s)",
    "Review 5 row(s) in the Quarantine tab that could not be repaired safely",
    "Manually inspect 11 cleaned row(s) still flagged `needs_review=TRUE` before relying on them downstream",
    "Normalize mixed date formats in Date (4 formats across about 47 populated row(s)) (auto-fixable)",
    "Review near-duplicate values in Department, Currency, Amount, Status to decide which versions should be merged or kept",
    "Manually check outlier values in Amount before trusting totals or downstream analysis"
  ],
  "assumptions": [
    "Rows that still contain Excel formulas as text (for example '=SUM(...)') are quarantined because they are not stable data values",
    "Ambiguous DD/MM vs MM/DD dates: day-first assumed; fallback to month-first if day-first is impossible",
    "MM-DD-YY two-digit years: treated as 2000â€“2049 for YY < 50, 1950â€“1999 for YY â‰¥ 50",
    "Unix timestamps: interpreted as UTC; converted to YYYY-MM-DD",
    "Excel serial dates: Windows epoch (1899-12-30); range 40,000â€“55,000 treated as dates",
    "European decimal 1.200,00: detected when period precedes comma; converted to 1200.00",
    "Combined values like '$1,200 USD' are split so Amount keeps the numeric value and Currency keeps the ISO code",
    "Blank / N/A / TBD amounts: cleared to empty string and flagged needs_review=TRUE",
    "\"INR â‚¹\" and similar symbol+code combos: symbol stripped, ISO code kept",
    "\"Eng\" department abbreviation: kept as-is (expanding abbreviations requires a lookup table)",
    "Short blank runs in categorical columns are forward-filled when they look like merged-cell export gaps; filled rows are flagged for review",
    "Rows with long single-cell prose are treated as notes/metadata rather than transactional data",
    "Rows labelled TOTAL/Subtotal/SUM are quarantined when the amount matches the running total closely enough to look calculated",
    "Near-duplicate rows (same Name/Amount/Currency/Category, date within 2 days): both kept, both flagged",
    "Exact duplicates: first occurrence kept; subsequent occurrences removed and logged",
    "Short rows (< 8 columns): padded with empty strings; flagged needs_review=TRUE",
    "Metadata export row (sparse, 1/8 fields filled): quarantined as 'Less than 50% columns filled'"
  ],
  "pii_warning": "âš ï¸ This file appears to contain PII. Handle according to your data protection policy.",
  "healing_projection": {
    "mode": "schema-specific",
    "clean_rows": 42,
    "quarantine_rows": 5,
    "needs_review_rows": 11,
    "modified_rows": 40,
    "action_counts": {
      "Fixed": 92,
      "Quarantined": 5,
      "Removed": 4,
      "Flagged": 2
    },
    "quarantine_reasons": {
      "Appears to be a notes row": 1,
      "Calculated subtotal row": 1,
      "Completely empty row": 1,
      "Row is all whitespace": 1,
      "Structural row (TOTAL/subtotal/header repeat)": 1
    }
  },
  "source_reports": {
    "diagnose": {
      "contract": {
        "name": "csv_doctor.diagnose",
        "version": "1.0.0"
      },
      "schema_version": "1.0.0",
      "tool_version": "0.5.0-dev",
      "file": "extreme_mess.csv",
      "detected_format": "csv",
      "detected_encoding": "WINDOWS-1250",
      "total_rows": 52,
      "healing_mode_candidate": "schema-specific",
      "dialect": {
        "delimiter": ","
      },
      "encoding": {
        "detected": "WINDOWS-1250",
        "confidence": 0.62,
        "is_utf8": false,
        "suspicious_chars": [
          "row 5: byte b'\\xe9' at position 73",
          "row 9: byte b'\\xed' at position 11",
          "row 18: byte b'\\xe9' at position 1"
        ]
      },
      "column_count": {
        "expected": 8,
        "misaligned_rows": [
          {
            "row": 10,
            "count": 9
          },
          {
            "row": 12,
            "count": 9
          },
          {
            "row": 22,
            "count": 9
          },
          {
            "row": 45,
            "count": 9
          },
          {
            "row": 48,
            "count": 9
          },
          {
            "row": 50,
            "count": 6
          },
          {
            "row": 51,
            "count": 5
          },
          {
            "row": 52,
            "count": 4
          }
        ]
      },
      "date_formats": {
        "Date": {
          "formats_found": [
            "DD/MM/YYYY or MM/DD/YYYY",
            "Month D, YYYY",
            "YYYY-MM-DD",
            "DD-MM-YY or MM-DD-YY"
          ],
          "examples": {
            "DD/MM/YYYY or MM/DD/YYYY": "15/03/2023",
            "Month D, YYYY": "March 15 2023",
            "YYYY-MM-DD": "2023-03-20",
            "DD-MM-YY or MM-DD-YY": "08-15-23"
          }
        }
      },
      "empty_rows": {
        "count": 2,
        "rows": [
          7,
          14
        ]
      },
      "duplicate_headers": {
        "duplicate_columns": [],
        "repeated_header_rows": [
          17
        ]
      },
      "whitespace_headers": [],
      "column_quality": {
        "empty_columns": [],
        "single_value_columns": {}
      },
      "column_semantics": {
        "columns": {
          "Employee Name": {
            "detected_type": "name",
            "type_scores": {
              "name": 84.09,
              "free text": 15.91
            },
            "null_count": 2,
            "null_percentage": 4.35,
            "unique_count": 39,
            "unique_percentage": 88.64,
            "most_common_values": [
              {
                "value": "Sarah Mitchell",
                "count": 3
              },
              {
                "value": "James Rodriguez",
                "count": 3
              },
              {
                "value": "Jessica Brown",
                "count": 2
              },
              {
                "value": "EXPENSE REPORT FY2023 -- Export: 2023-12-31 | HR System Pro v4.2",
                "count": 1
              },
              {
                "value": "Sophie Bernard",
                "count": 1
              }
            ],
            "min_value": null,
            "max_value": null,
            "sample_values": [
              "Lisa Thompson",
              "Sarah Mitchell",
              "Rachel Green"
            ],
            "has_mixed_types": false,
            "suspected_issues": [
              "Inconsistent capitalisation",
              "Possible PII detected (emails/phones/names)"
            ]
          },
          "Department": {
            "detected_type": "categorical",
            "type_scores": {
              "country name or code": 7.14,
              "free text": 92.86
            },
            "null_count": 4,
            "null_percentage": 8.7,
            "unique_count": 11,
            "unique_percentage": 26.19,
            "most_common_values": [
              {
                "value": "Marketing",
                "count": 8
              },
              {
                "value": "Engineering",
                "count": 7
              },
              {
                "value": "Finance",
                "count": 6
              },
              {
                "value": "Sales",
                "count": 6
              },
              {
                "value": "HR",
                "count": 4
              }
            ],
            "min_value": null,
            "max_value": null,
            "sample_values": [
              "engineering dept",
              "Engineering",
              "Marketing"
            ],
            "has_mixed_types": false,
            "suspected_issues": [
              "Inconsistent capitalisation",
              "Possible duplicates with slight differences"
            ]
          },
          "Date": {
            "detected_type": "date",
            "type_scores": {
              "date": 90.48,
              "plain number": 4.76,
              "phone number": 2.38,
              "free text": 2.38
            },
            "null_count": 4,
            "null_percentage": 8.7,
            "unique_count": 38,
            "unique_percentage": 90.48,
            "most_common_values": [
              {
                "value": "15/03/2023",
                "count": 3
              },
              {
                "value": "2023-01-18T00:00:00Z",
                "count": 3
              },
              {
                "value": "20/04/2023",
                "count": 1
              },
              {
                "value": "22/11/2023",
                "count": 1
              },
              {
                "value": "March 15 2023",
                "count": 1
              }
            ],
            "min_value": "2023-01-05",
            "max_value": "2023-12-28",
            "sample_values": [
              "2023-03-20",
              "2023-01-18T00:00:00Z",
              "44910"
            ],
            "has_mixed_types": false,
            "suspected_issues": [
              "Mixed date formats detected",
              "Inconsistent capitalisation"
            ]
          },
          "Amount": {
            "detected_type": "currency/amount",
            "type_scores": {
              "date": 22.5,
              "currency/amount": 10.0,
              "plain number": 62.5,
              "phone number": 2.5,
              "free text": 2.5
            },
            "null_count": 6,
            "null_percentage": 13.04,
            "unique_count": 28,
            "unique_percentage": 70.0,
            "most_common_values": [
              {
                "value": "450.00",
                "count": 5
              },
              {
                "value": "$1,200.00",
                "count": 3
              },
              {
                "value": "567.00",
                "count": 3
              },
              {
                "value": "89.50",
                "count": 2
              },
              {
                "value": "234.00",
                "count": 2
              }
            ],
            "min_value": -500.0,
            "max_value": 45234.5,
            "sample_values": [
              "89.00",
              "567.00",
              "$1,200.00"
            ],
            "has_mixed_types": true,
            "suspected_issues": [
              "Possible duplicates with slight differences",
              "Outliers detected (values outside 3 standard deviations)"
            ]
          },
          "Currency": {
            "detected_type": "currency code",
            "type_scores": {
              "currency code": 87.8,
              "name": 2.44,
              "free text": 9.76
            },
            "null_count": 5,
            "null_percentage": 10.87,
            "unique_count": 8,
            "unique_percentage": 19.51,
            "most_common_values": [
              {
                "value": "USD",
                "count": 30
              },
              {
                "value": "usd",
                "count": 3
              },
              {
                "value": "EUR",
                "count": 3
              },
              {
                "value": "US Dollar",
                "count": 1
              },
              {
                "value": "INR â‚¹",
                "count": 1
              }
            ],
            "min_value": null,
            "max_value": null,
            "sample_values": [
              "usd",
              "USD",
              "$"
            ],
            "has_mixed_types": false,
            "suspected_issues": [
              "Inconsistent capitalisation",
              "Possible duplicates with slight differences"
            ]
          },
          "Category": {
            "detected_type": "categorical",
            "type_scores": {
              "name": 5.0,
              "free text": 95.0
            },
            "null_count": 6,
            "null_percentage": 13.04,
            "unique_count": 8,
            "unique_percentage": 20.0,
            "most_common_values": [
              {
                "value": "Travel",
                "count": 13
              },
              {
                "value": "Training",
                "count": 6
              },
              {
                "value": "Software",
                "count": 5
              },
              {
                "value": "Entertainment",
                "count": 5
              },
              {
                "value": "Meals",
                "count": 4
              }
            ],
            "min_value": null,
            "max_value": null,
            "sample_values": [
              "Software",
              "Travel",
              "Equipment"
            ],
            "has_mixed_types": false,
            "suspected_issues": []
          },
          "Status": {
            "detected_type": "categorical",
            "type_scores": {
              "name": 5.13,
              "free text": 15.38,
              "boolean": 79.49
            },
            "null_count": 7,
            "null_percentage": 15.22,
            "unique_count": 10,
            "unique_percentage": 25.64,
            "most_common_values": [
              {
                "value": "Approved",
                "count": 12
              },
              {
                "value": "approved",
                "count": 12
              },
              {
                "value": "APPROVED",
                "count": 3
              },
              {
                "value": "pending",
                "count": 3
              },
              {
                "value": "Pending",
                "count": 2
              }
            ],
            "min_value": null,
            "max_value": null,
            "sample_values": [
              "approved",
              "Approved",
              "rejected"
            ],
            "has_mixed_types": false,
            "suspected_issues": [
              "Inconsistent capitalisation",
              "Possible duplicates with slight differences"
            ]
          },
          "Notes": {
            "detected_type": "free text",
            "type_scores": {
              "free text": 100.0
            },
            "null_count": 7,
            "null_percentage": 15.22,
            "unique_count": 33,
            "unique_percentage": 84.62,
            "most_common_values": [
              {
                "value": "Flight to NYC for client meeting",
                "count": 3
              },
              {
                "value": "Annual license renewal",
                "count": 3
              },
              {
                "value": "Train to Boston quarterly review",
                "count": 2
              },
              {
                "value": "Keyboard and mouse",
                "count": 2
              },
              {
                "value": "Lunch at cafÃ© Rouge - team outing",
                "count": 1
              }
            ],
            "min_value": null,
            "max_value": null,
            "sample_values": [
              "Mumbai to Delhi flight",
              "Annual license renewal",
              "Overpayment reversal"
            ],
            "has_mixed_types": false,
            "suspected_issues": []
          }
        },
        "summary": {
          "total_rows": 46,
          "total_columns": 8,
          "detected_types": {
            "categorical": 3,
            "currency code": 1,
            "currency/amount": 1,
            "date": 1,
            "free text": 1,
            "name": 1
          },
          "issue_counts": {
            "Inconsistent capitalisation": 5,
            "Mixed date formats detected": 1,
            "Outliers detected (values outside 3 standard deviations)": 1,
            "Possible PII detected (emails/phones/names)": 1,
            "Possible duplicates with slight differences": 4
          }
        }
      },
      "row_accounting": {
        "raw_rows_total": 52,
        "raw_data_rows_total": 51,
        "parsed_rows_total": 46,
        "malformed_rows_total": 8,
        "malformed_rows": [
          {
            "row": 10,
            "count": 9
          },
          {
            "row": 12,
            "count": 9
          },
          {
            "row": 22,
            "count": 9
          },
          {
            "row": 45,
            "count": 9
          },
          {
            "row": 48,
            "count": 9
          },
          {
            "row": 50,
            "count": 6
          },
          {
            "row": 51,
            "count": 5
          },
          {
            "row": 52,
            "count": 4
          }
        ],
        "dropped_rows_total": 5
      },
      "loader_warnings": [
        "DataFrame parser skipped 5 data row(s); raw row counts are retained for reporting."
      ],
      "degraded_mode": {
        "active": false,
        "reasons": []
      },
      "issues": [
        {
          "id": "structural_misaligned_rows",
          "severity": "critical",
          "plain_english": "Some rows have too many or too few columns, which will break imports and shift values into the wrong fields.",
          "columns": [
            "row structure"
          ],
          "rows_affected": 8,
          "auto_fixable": true,
          "details": {
            "rows": [
              {
                "row": 10,
                "count": 9
              },
              {
                "row": 12,
                "count": 9
              },
              {
                "row": 22,
                "count": 9
              },
              {
                "row": 45,
                "count": 9
              },
              {
                "row": 48,
                "count": 9
              },
              {
                "row": 50,
                "count": 6
              },
              {
                "row": 51,
                "count": 5
              },
              {
                "row": 52,
                "count": 4
              }
            ]
          }
        },
        {
          "id": "structural_repeated_header_rows",
          "severity": "critical",
          "plain_english": "The header row appears again inside the data, which will be treated as a broken data row during import.",
          "columns": [
            "row structure"
          ],
          "rows_affected": 1,
          "auto_fixable": true,
          "details": {
            "rows": [
              17
            ]
          }
        },
        {
          "id": "encoding_non_utf8",
          "severity": "warning",
          "plain_english": "The file uses WINDOWS-1250 instead of UTF-8, so some systems may misread special characters.",
          "columns": [
            "file-wide"
          ],
          "rows_affected": 51,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "semantic_inconsistent_capitalisation",
          "severity": "warning",
          "plain_english": "The Employee Name column uses inconsistent capitalisation, which can split what should be one category into several versions.",
          "columns": [
            "Employee Name"
          ],
          "rows_affected": 49,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "date_mixed_formats",
          "severity": "warning",
          "plain_english": "The Date column mixes multiple date formats, so the same date may be interpreted differently by different tools.",
          "columns": [
            "Date"
          ],
          "rows_affected": 47,
          "auto_fixable": true,
          "details": {
            "formats_found": [
              "DD/MM/YYYY or MM/DD/YYYY",
              "Month D, YYYY",
              "YYYY-MM-DD",
              "DD-MM-YY or MM-DD-YY"
            ]
          }
        },
        {
          "id": "semantic_inconsistent_capitalisation",
          "severity": "warning",
          "plain_english": "The Department column uses inconsistent capitalisation, which can split what should be one category into several versions.",
          "columns": [
            "Department"
          ],
          "rows_affected": 47,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "semantic_near_duplicates",
          "severity": "warning",
          "plain_english": "The Department column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.",
          "columns": [
            "Department"
          ],
          "rows_affected": 47,
          "auto_fixable": false,
          "details": {}
        },
        {
          "id": "semantic_inconsistent_capitalisation",
          "severity": "warning",
          "plain_english": "The Currency column uses inconsistent capitalisation, which can split what should be one category into several versions.",
          "columns": [
            "Currency"
          ],
          "rows_affected": 46,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "semantic_near_duplicates",
          "severity": "warning",
          "plain_english": "The Currency column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.",
          "columns": [
            "Currency"
          ],
          "rows_affected": 46,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "semantic_near_duplicates",
          "severity": "warning",
          "plain_english": "The Amount column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.",
          "columns": [
            "Amount"
          ],
          "rows_affected": 45,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "semantic_outliers",
          "severity": "warning",
          "plain_english": "The Amount column contains outlier values that look unusually large or small compared with the rest of the file.",
          "columns": [
            "Amount"
          ],
          "rows_affected": 45,
          "auto_fixable": false,
          "details": {}
        },
        {
          "id": "semantic_inconsistent_capitalisation",
          "severity": "warning",
          "plain_english": "The Status column uses inconsistent capitalisation, which can split what should be one category into several versions.",
          "columns": [
            "Status"
          ],
          "rows_affected": 44,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "semantic_near_duplicates",
          "severity": "warning",
          "plain_english": "The Status column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.",
          "columns": [
            "Status"
          ],
          "rows_affected": 44,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "encoding_suspicious_chars",
          "severity": "warning",
          "plain_english": "Some characters look corrupted, which may change names, notes, or other text values.",
          "columns": [
            "file-wide"
          ],
          "rows_affected": 3,
          "auto_fixable": true,
          "details": {}
        },
        {
          "id": "structural_empty_rows",
          "severity": "warning",
          "plain_english": "Completely blank rows are mixed into the file and can interfere with import counts and analysis.",
          "columns": [
            "row structure"
          ],
          "rows_affected": 2,
          "auto_fixable": true,
          "details": {
            "rows": [
              7,
              14
            ]
          }
        },
        {
          "id": "semantic_pii",
          "severity": "info",
          "plain_english": "The Employee Name column appears to contain personally identifiable information that may need extra care before sharing.",
          "columns": [
            "Employee Name"
          ],
          "rows_affected": 49,
          "auto_fixable": false,
          "details": {}
        }
      ],
      "summary": {
        "verdict": "CRITICAL",
        "issue_count": 7
      },
      "run_summary": {
        "tool": "csv-doctor",
        "script": "diagnose.py",
        "status": "ok",
        "generated_at": "2026-03-01T06:17:39Z",
        "input_file": "sample-data/extreme_mess.csv",
        "output_file": null,
        "warnings_count": 1,
        "warnings": [
          "DataFrame parser skipped 5 data row(s); raw row counts are retained for reporting."
        ],
        "metrics": {
          "detected_format": "csv",
          "healing_mode_candidate": "schema-specific",
          "raw_rows_total": 52,
          "parsed_rows_total": 46,
          "issues_found": 7,
          "verdict": "CRITICAL",
          "degraded_mode_active": false
        }
      }
    },
    "column_detector": {
      "columns": {
        "Employee Name": {
          "detected_type": "name",
          "type_scores": {
            "name": 84.09,
            "free text": 15.91
          },
          "null_count": 2,
          "null_percentage": 4.35,
          "unique_count": 39,
          "unique_percentage": 88.64,
          "most_common_values": [
            {
              "value": "Sarah Mitchell",
              "count": 3
            },
            {
              "value": "James Rodriguez",
              "count": 3
            },
            {
              "value": "Jessica Brown",
              "count": 2
            },
            {
              "value": "EXPENSE REPORT FY2023 -- Export: 2023-12-31 | HR System Pro v4.2",
              "count": 1
            },
            {
              "value": "Sophie Bernard",
              "count": 1
            }
          ],
          "min_value": null,
          "max_value": null,
          "sample_values": [
            "Lisa Thompson",
            "Sarah Mitchell",
            "Rachel Green"
          ],
          "has_mixed_types": false,
          "suspected_issues": [
            "Inconsistent capitalisation",
            "Possible PII detected (emails/phones/names)"
          ]
        },
        "Department": {
          "detected_type": "categorical",
          "type_scores": {
            "country name or code": 7.14,
            "free text": 92.86
          },
          "null_count": 4,
          "null_percentage": 8.7,
          "unique_count": 11,
          "unique_percentage": 26.19,
          "most_common_values": [
            {
              "value": "Marketing",
              "count": 8
            },
            {
              "value": "Engineering",
              "count": 7
            },
            {
              "value": "Finance",
              "count": 6
            },
            {
              "value": "Sales",
              "count": 6
            },
            {
              "value": "HR",
              "count": 4
            }
          ],
          "min_value": null,
          "max_value": null,
          "sample_values": [
            "engineering dept",
            "Engineering",
            "Marketing"
          ],
          "has_mixed_types": false,
          "suspected_issues": [
            "Inconsistent capitalisation",
            "Possible duplicates with slight differences"
          ]
        },
        "Date": {
          "detected_type": "date",
          "type_scores": {
            "date": 90.48,
            "plain number": 4.76,
            "phone number": 2.38,
            "free text": 2.38
          },
          "null_count": 4,
          "null_percentage": 8.7,
          "unique_count": 38,
          "unique_percentage": 90.48,
          "most_common_values": [
            {
              "value": "15/03/2023",
              "count": 3
            },
            {
              "value": "2023-01-18T00:00:00Z",
              "count": 3
            },
            {
              "value": "20/04/2023",
              "count": 1
            },
            {
              "value": "22/11/2023",
              "count": 1
            },
            {
              "value": "March 15 2023",
              "count": 1
            }
          ],
          "min_value": "2023-01-05",
          "max_value": "2023-12-28",
          "sample_values": [
            "2023-03-20",
            "2023-01-18T00:00:00Z",
            "44910"
          ],
          "has_mixed_types": false,
          "suspected_issues": [
            "Mixed date formats detected",
            "Inconsistent capitalisation"
          ]
        },
        "Amount": {
          "detected_type": "currency/amount",
          "type_scores": {
            "date": 22.5,
            "currency/amount": 10.0,
            "plain number": 62.5,
            "phone number": 2.5,
            "free text": 2.5
          },
          "null_count": 6,
          "null_percentage": 13.04,
          "unique_count": 28,
          "unique_percentage": 70.0,
          "most_common_values": [
            {
              "value": "450.00",
              "count": 5
            },
            {
              "value": "$1,200.00",
              "count": 3
            },
            {
              "value": "567.00",
              "count": 3
            },
            {
              "value": "89.50",
              "count": 2
            },
            {
              "value": "234.00",
              "count": 2
            }
          ],
          "min_value": -500.0,
          "max_value": 45234.5,
          "sample_values": [
            "89.00",
            "567.00",
            "$1,200.00"
          ],
          "has_mixed_types": true,
          "suspected_issues": [
            "Possible duplicates with slight differences",
            "Outliers detected (values outside 3 standard deviations)"
          ]
        },
        "Currency": {
          "detected_type": "currency code",
          "type_scores": {
            "currency code": 87.8,
            "name": 2.44,
            "free text": 9.76
          },
          "null_count": 5,
          "null_percentage": 10.87,
          "unique_count": 8,
          "unique_percentage": 19.51,
          "most_common_values": [
            {
              "value": "USD",
              "count": 30
            },
            {
              "value": "usd",
              "count": 3
            },
            {
              "value": "EUR",
              "count": 3
            },
            {
              "value": "US Dollar",
              "count": 1
            },
            {
              "value": "INR â‚¹",
              "count": 1
            }
          ],
          "min_value": null,
          "max_value": null,
          "sample_values": [
            "usd",
            "USD",
            "$"
          ],
          "has_mixed_types": false,
          "suspected_issues": [
            "Inconsistent capitalisation",
            "Possible duplicates with slight differences"
          ]
        },
        "Category": {
          "detected_type": "categorical",
          "type_scores": {
            "name": 5.0,
            "free text": 95.0
          },
          "null_count": 6,
          "null_percentage": 13.04,
          "unique_count": 8,
          "unique_percentage": 20.0,
          "most_common_values": [
            {
              "value": "Travel",
              "count": 13
            },
            {
              "value": "Training",
              "count": 6
            },
            {
              "value": "Software",
              "count": 5
            },
            {
              "value": "Entertainment",
              "count": 5
            },
            {
              "value": "Meals",
              "count": 4
            }
          ],
          "min_value": null,
          "max_value": null,
          "sample_values": [
            "Software",
            "Travel",
            "Equipment"
          ],
          "has_mixed_types": false,
          "suspected_issues": []
        },
        "Status": {
          "detected_type": "categorical",
          "type_scores": {
            "name": 5.13,
            "free text": 15.38,
            "boolean": 79.49
          },
          "null_count": 7,
          "null_percentage": 15.22,
          "unique_count": 10,
          "unique_percentage": 25.64,
          "most_common_values": [
            {
              "value": "Approved",
              "count": 12
            },
            {
              "value": "approved",
              "count": 12
            },
            {
              "value": "APPROVED",
              "count": 3
            },
            {
              "value": "pending",
              "count": 3
            },
            {
              "value": "Pending",
              "count": 2
            }
          ],
          "min_value": null,
          "max_value": null,
          "sample_values": [
            "approved",
            "Approved",
            "rejected"
          ],
          "has_mixed_types": false,
          "suspected_issues": [
            "Inconsistent capitalisation",
            "Possible duplicates with slight differences"
          ]
        },
        "Notes": {
          "detected_type": "free text",
          "type_scores": {
            "free text": 100.0
          },
          "null_count": 7,
          "null_percentage": 15.22,
          "unique_count": 33,
          "unique_percentage": 84.62,
          "most_common_values": [
            {
              "value": "Flight to NYC for client meeting",
              "count": 3
            },
            {
              "value": "Annual license renewal",
              "count": 3
            },
            {
              "value": "Train to Boston quarterly review",
              "count": 2
            },
            {
              "value": "Keyboard and mouse",
              "count": 2
            },
            {
              "value": "Lunch at cafÃ© Rouge - team outing",
              "count": 1
            }
          ],
          "min_value": null,
          "max_value": null,
          "sample_values": [
            "Mumbai to Delhi flight",
            "Annual license renewal",
            "Overpayment reversal"
          ],
          "has_mixed_types": false,
          "suspected_issues": []
        }
      },
      "summary": {
        "total_rows": 46,
        "total_columns": 8,
        "detected_types": {
          "categorical": 3,
          "currency code": 1,
          "currency/amount": 1,
          "date": 1,
          "free text": 1,
          "name": 1
        },
        "issue_counts": {
          "Inconsistent capitalisation": 5,
          "Mixed date formats detected": 1,
          "Outliers detected (values outside 3 standard deviations)": 1,
          "Possible PII detected (emails/phones/names)": 1,
          "Possible duplicates with slight differences": 4
        }
      }
    }
  },
  "run_summary": {
    "tool": "csv-doctor",
    "script": "reporter.py",
    "status": "ok",
    "generated_at": "2026-03-01T06:17:39Z",
    "input_file": "sample-data/extreme_mess.csv",
    "output_file": null,
    "warnings_count": 0,
    "warnings": [],
    "metrics": {
      "detected_format": "csv",
      "healing_mode": "schema-specific",
      "raw_health_score": 32,
      "recoverability_score": 71,
      "post_heal_score": 79,
      "clean_rows": 42,
      "quarantine_rows": 5,
      "issues_found": 16
    }
  },
  "text_report": "SECTION 1 â€” FILE OVERVIEW\nðŸ“„ File: extreme_mess.csv\nðŸ“Š Size: 51 rows Ã— 8 columns\nðŸ§¾ Parsed cleanly: 46 rows\nðŸ§¯ Malformed rows: 8 | Skipped by parser: 5\nðŸ’¾ Format: csv\nðŸ”¤ Encoding: WINDOWS-1250\nâ±  Scanned: 2026-03-01T11:47:39\n\nSECTION 2 â€” HEALTH SCORE\nðŸ©º Raw Health Score: 32/100 (Poor â€” major surgery required)\nðŸ›Ÿ Recoverability Score: 71/100 (Good â€” a few issues to address)\nâœ¨ Post-Heal Score: 79/100 (Good â€” a few issues to address)\n  â€¢ Raw deductions â€” Encoding: -10, Structural: -30, Date chaos: -5, Missing data: -3, Duplicates: -10, Data quality: -10\n  â€¢ Healing projection â€” Clean rows: 42, Quarantine rows: 5, Needs review: 11, Fixed changes: 92\n\nâš ï¸ This file appears to contain PII. Handle according to your data protection policy.\n\nSECTION 3 â€” ISSUES FOUND\nðŸš¨ Critical (will break imports)\n- Some rows have too many or too few columns, which will break imports and shift values into the wrong fields.\n  Columns: row structure\n  Rows affected: 8\n  Auto-fixable: âœ…\n- The header row appears again inside the data, which will be treated as a broken data row during import.\n  Columns: row structure\n  Rows affected: 1\n  Auto-fixable: âœ…\n\nâš ï¸  Warning (will cause analysis errors)\n- The file uses WINDOWS-1250 instead of UTF-8, so some systems may misread special characters.\n  Columns: file-wide\n  Rows affected: 51\n  Auto-fixable: âœ…\n- The Employee Name column uses inconsistent capitalisation, which can split what should be one category into several versions.\n  Columns: Employee Name\n  Rows affected: 49\n  Auto-fixable: âœ…\n- The Date column mixes multiple date formats, so the same date may be interpreted differently by different tools.\n  Columns: Date\n  Rows affected: 47\n  Auto-fixable: âœ…\n- The Department column uses inconsistent capitalisation, which can split what should be one category into several versions.\n  Columns: Department\n  Rows affected: 47\n  Auto-fixable: âœ…\n- The Department column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.\n  Columns: Department\n  Rows affected: 47\n  Auto-fixable: âŒ\n- The Currency column uses inconsistent capitalisation, which can split what should be one category into several versions.\n  Columns: Currency\n  Rows affected: 46\n  Auto-fixable: âœ…\n- The Currency column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.\n  Columns: Currency\n  Rows affected: 46\n  Auto-fixable: âœ…\n- The Amount column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.\n  Columns: Amount\n  Rows affected: 45\n  Auto-fixable: âœ…\n- The Amount column contains outlier values that look unusually large or small compared with the rest of the file.\n  Columns: Amount\n  Rows affected: 45\n  Auto-fixable: âŒ\n- The Status column uses inconsistent capitalisation, which can split what should be one category into several versions.\n  Columns: Status\n  Rows affected: 44\n  Auto-fixable: âœ…\n- The Status column appears to contain near-duplicate values that differ only slightly, such as spacing or casing changes.\n  Columns: Status\n  Rows affected: 44\n  Auto-fixable: âœ…\n- Some characters look corrupted, which may change names, notes, or other text values.\n  Columns: file-wide\n  Rows affected: 3\n  Auto-fixable: âœ…\n- Completely blank rows are mixed into the file and can interfere with import counts and analysis.\n  Columns: row structure\n  Rows affected: 2\n  Auto-fixable: âœ…\n\nâ„¹ï¸  Info (cosmetic, worth fixing)\n- The Employee Name column appears to contain personally identifiable information that may need extra care before sharing.\n  Columns: Employee Name\n  Rows affected: 49\n  Auto-fixable: âŒ\n\nSECTION 4 â€” COLUMN BREAKDOWN\nEmployee Name | name | 4.35% null | Inconsistent capitalisation; Possible PII detected (emails/phones/names)\nDepartment | categorical | 8.7% null | Inconsistent capitalisation; Possible duplicates with slight differences\nDate | date | 8.7% null | Mixed date formats detected; Inconsistent capitalisation\nAmount | currency/amount | 13.04% null | Possible duplicates with slight differences; Outliers detected (values outside 3 standard deviations)\nCurrency | currency code | 10.87% null | Inconsistent capitalisation; Possible duplicates with slight differences\nCategory | categorical | 13.04% null | No major issues detected\nStatus | categorical | 15.22% null | Inconsistent capitalisation; Possible duplicates with slight differences\nNotes | free text | 15.22% null | No major issues detected\n\nSECTION 5 â€” RECOMMENDED ACTIONS\n1. Run sheet-doctor healing now: it can automatically address 8 issue type(s) across 13 flagged issue instance(s)\n2. Review 5 row(s) in the Quarantine tab that could not be repaired safely\n3. Manually inspect 11 cleaned row(s) still flagged `needs_review=TRUE` before relying on them downstream\n4. Normalize mixed date formats in Date (4 formats across about 47 populated row(s)) (auto-fixable)\n5. Review near-duplicate values in Department, Currency, Amount, Status to decide which versions should be merged or kept\n6. Manually check outlier values in Amount before trusting totals or downstream analysis\n\nSECTION 6 â€” ASSUMPTIONS\nâ€¢ Rows that still contain Excel formulas as text (for example '=SUM(...)') are quarantined because they are not stable data values\nâ€¢ Ambiguous DD/MM vs MM/DD dates: day-first assumed; fallback to month-first if day-first is impossible\nâ€¢ MM-DD-YY two-digit years: treated as 2000â€“2049 for YY < 50, 1950â€“1999 for YY â‰¥ 50\nâ€¢ Unix timestamps: interpreted as UTC; converted to YYYY-MM-DD\nâ€¢ Excel serial dates: Windows epoch (1899-12-30); range 40,000â€“55,000 treated as dates\nâ€¢ European decimal 1.200,00: detected when period precedes comma; converted to 1200.00\nâ€¢ Combined values like '$1,200 USD' are split so Amount keeps the numeric value and Currency keeps the ISO code\nâ€¢ Blank / N/A / TBD amounts: cleared to empty string and flagged needs_review=TRUE\nâ€¢ \"INR â‚¹\" and similar symbol+code combos: symbol stripped, ISO code kept\nâ€¢ \"Eng\" department abbreviation: kept as-is (expanding abbreviations requires a lookup table)\nâ€¢ Short blank runs in categorical columns are forward-filled when they look like merged-cell export gaps; filled rows are flagged for review\nâ€¢ Rows with long single-cell prose are treated as notes/metadata rather than transactional data\nâ€¢ Rows labelled TOTAL/Subtotal/SUM are quarantined when the amount matches the running total closely enough to look calculated\nâ€¢ Near-duplicate rows (same Name/Amount/Currency/Category, date within 2 days): both kept, both flagged\nâ€¢ Exact duplicates: first occurrence kept; subsequent occurrences removed and logged\nâ€¢ Short rows (< 8 columns): padded with empty strings; flagged needs_review=TRUE\nâ€¢ Metadata export row (sparse, 1/8 fields filled): quarantined as 'Less than 50% columns filled'\n"
}